.ws-shell {
  height: 100vh;
  background: var(--neu-bg);
  color: var(--neu-fg);
  font-family: 'DM Sans', sans-serif;
  overflow: hidden;
}

.ws-topbar {
  background: var(--neu-bg);
  height: 56px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 24px;
  border-bottom: 1px solid rgba(163, 177, 198, 0.2);
  z-index: 10;
  position: relative;
}

.ws-brand-wrap {
  display: flex;
  align-items: baseline;
  gap: 12px;
}

.ws-brand {
  font-family: 'Plus Jakarta Sans', sans-serif;
  font-size: 18px;
  font-weight: 700;
  color: var(--neu-fg);
  letter-spacing: -0.02em;
}

.ws-subtitle {
  font-size: 12px;
  color: var(--neu-muted);
  font-weight: 400;
}

.ws-flow {
  display: flex;
  align-items: center;
  gap: 4px;
}

.ws-step {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 12px;
  font-weight: 500;
  padding: 6px 12px;
  border-radius: 8px;
  transition: all 0.2s ease-out;
  color: var(--neu-muted);
}

.ws-step-idle {
  color: var(--neu-muted);
  opacity: 0.6;
}

.ws-step-active {
  color: var(--neu-accent);
  background: rgba(108, 99, 255, 0.1);
}

.ws-step-done {
  color: var(--neu-success);
}

.ws-step-done::after {
  content: "✓";
  margin-left: 4px;
  font-size: 10px;
}

.ws-status {
  display: flex;
  align-items: center;
  gap: 12px;
  font-size: 11px;
  font-weight: 500;
  color: var(--neu-muted);
}

.ws-status span {
  display: flex;
  align-items: center;
  gap: 4px;
}

.ws-status span:not(:last-child)::after {
  content: "·";
  color: var(--neu-muted);
  opacity: 0.5;
  margin-left: 12px;
}

.ws-settings-btn {
  color: var(--neu-muted) !important;
  border-radius: 8px !important;
  transition: color 0.2s, box-shadow 0.2s;
}
.ws-settings-btn:hover {
  color: var(--neu-accent) !important;
  box-shadow: var(--neu-extruded-sm);
}

.ws-content {
  padding: 24px;
  height: calc(100vh - 56px);
}

.ws-main-grid {
  display: grid;
  grid-template-columns: 320px 1fr 360px;
  gap: 20px;
  height: 100%;
}

.ws-panel {
  background: var(--neu-bg);
  border-radius: 24px;
  box-shadow: var(--neu-extruded);
  display: flex;
  flex-direction: column;
  overflow: hidden;
  transition: width 0.25s ease, min-width 0.25s ease;
}

.ws-panel-head {
  padding: 16px 20px 12px;
  font-family: 'Plus Jakarta Sans', sans-serif;
  font-weight: 600;
  font-size: 14px;
  color: var(--neu-fg);
  border-bottom: 1px solid rgba(163, 177, 198, 0.15);
  flex-shrink: 0;
}

.ws-panel-head-between {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.ws-legend {
  display: flex;
  align-items: center;
  gap: 12px;
  font-family: 'DM Sans', sans-serif;
  font-size: 11px;
  font-weight: 500;
  color: var(--neu-muted);
}

.ws-legend span {
  display: flex;
  align-items: center;
  gap: 4px;
}

.dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  display: inline-block;
}

.dot-executed {
  background: var(--neu-accent);
}

.dot-idle {
  background: var(--neu-muted);
  opacity: 0.4;
}

.line {
  width: 16px;
  height: 2px;
  display: inline-block;
  margin-right: 4px;
}

.line-definite {
  background: var(--neu-accent);
  height: 2px;
}

/* CFG Node Styles - Better visibility and colors */
.cfg-node-base,
.cfg-node-start,
.cfg-node-end,
.cfg-node-branch,
.cfg-node-loop,
.cfg-node-dml,
.cfg-node-select,
.cfg-node-call,
.cfg-node-trycatch,
.cfg-node-catch,
.cfg-node-transaction,
.cfg-node-dynamic,
.cfg-node-statement,
.cfg-node-block {
  background: var(--neu-bg);
  border: 2px solid;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  transition: all 0.3s ease;
}

.cfg-node-base:hover,
.cfg-node-start:hover,
.cfg-node-end:hover,
.cfg-node-branch:hover,
.cfg-node-loop:hover,
.cfg-node-dml:hover,
.cfg-node-select:hover,
.cfg-node-call:hover,
.cfg-node-trycatch:hover,
.cfg-node-catch:hover,
.cfg-node-transaction:hover,
.cfg-node-dynamic:hover,
.cfg-node-statement:hover,
.cfg-node-block:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 12px rgba(0,0,0,0.15);
}

/* Start/End nodes */
.cfg-node-start {
  border-color: #48BB78;
  background: linear-gradient(135deg, #E6FFFA 0%, #B2F5EA 100%);
}
.cfg-node-start-executed {
  border-color: #38A169;
  background: linear-gradient(135deg, #9AE6B4 0%, #68D391 100%);
  box-shadow: 0 0 20px rgba(72, 187, 120, 0.4);
}

.cfg-node-end {
  border-color: #F56565;
  background: linear-gradient(135deg, #FFF5F5 0%, #FED7D7 100%);
}
.cfg-node-end-executed {
  border-color: #E53E3E;
  background: linear-gradient(135deg, #FC8181 0%, #F56565 100%);
  box-shadow: 0 0 20px rgba(245, 101, 101, 0.4);
}

/* Branch/Loop nodes */
.cfg-node-branch {
  border-color: #ED8936;
  background: linear-gradient(135deg, #FFFAF0 0%, #FBD38D 100%);
}
.cfg-node-branch-executed {
  border-color: #DD6B20;
  background: linear-gradient(135deg, #F6AD55 0%, #ED8936 100%);
  box-shadow: 0 0 20px rgba(237, 137, 54, 0.4);
}

.cfg-node-loop {
  border-color: #9F7AEA;
  background: linear-gradient(135deg, #FAF5FF 0%, #E9D8FD 100%);
}
.cfg-node-loop-executed {
  border-color: #805AD5;
  background: linear-gradient(135deg, #B794F4 0%, #9F7AEA 100%);
  box-shadow: 0 0 20px rgba(159, 122, 234, 0.4);
}

/* DML/Select nodes */
.cfg-node-dml {
  border-color: #4299E1;
  background: linear-gradient(135deg, #EBF8FF 0%, #BEE3F8 100%);
}
.cfg-node-dml-executed {
  border-color: #3182CE;
  background: linear-gradient(135deg, #63B3ED 0%, #4299E1 100%);
  box-shadow: 0 0 20px rgba(66, 153, 225, 0.4);
}

.cfg-node-select {
  border-color: #38B2AC;
  background: linear-gradient(135deg, #E6FFFA 0%, #81E6D9 100%);
}
.cfg-node-select-executed {
  border-color: #319795;
  background: linear-gradient(135deg, #4FD1C5 0%, #38B2AC 100%);
  box-shadow: 0 0 20px rgba(56, 178, 172, 0.4);
}

/* Call nodes */
.cfg-node-call {
  border-color: #D69E2E;
  background: linear-gradient(135deg, #FFFBEB 0%, #F6E05E 100%);
}
.cfg-node-call-executed {
  border-color: #B7791F;
  background: linear-gradient(135deg, #ECC94B 0%, #D69E2E 100%);
  box-shadow: 0 0 20px rgba(214, 158, 46, 0.4);
}

/* Try/Catch nodes */
.cfg-node-trycatch {
  border-color: #718096;
  background: linear-gradient(135deg, #F7FAFC 0%, #CBD5E0 100%);
}
.cfg-node-trycatch-executed {
  border-color: #4A5568;
  background: linear-gradient(135deg, #A0AEC0 0%, #718096 100%);
  box-shadow: 0 0 20px rgba(113, 128, 150, 0.4);
}

.cfg-node-catch {
  border-color: #E53E3E;
  background: linear-gradient(135deg, #FFF5F5 0%, #FED7D7 100%);
}
.cfg-node-catch-executed {
  border-color: #C53030;
  background: linear-gradient(135deg, #FC8181 0%, #F56565 100%);
  box-shadow: 0 0 20px rgba(229, 62, 62, 0.4);
}

/* Transaction nodes */
.cfg-node-transaction {
  border-color: #805AD5;
  background: linear-gradient(135deg, #FAF5FF 0%, #D6BCFA 100%);
}
.cfg-node-transaction-executed {
  border-color: #6B46C1;
  background: linear-gradient(135deg, #B794F4 0%, #805AD5 100%);
  box-shadow: 0 0 20px rgba(128, 90, 213, 0.4);
}

/* Dynamic SQL nodes */
.cfg-node-dynamic {
  border-color: #D53F8C;
  background: linear-gradient(135deg, #FFF5F7 0%, #FED7E2 100%);
}
.cfg-node-dynamic-executed {
  border-color: #B83280;
  background: linear-gradient(135deg, #F687B3 0%, #D53F8C 100%);
  box-shadow: 0 0 20px rgba(213, 63, 140, 0.4);
}

/* Statement/Block nodes */
.cfg-node-statement {
  border-color: #718096;
  background: linear-gradient(135deg, #F7FAFC 0%, #E2E8F0 100%);
}
.cfg-node-statement-executed {
  border-color: #4A5568;
  background: linear-gradient(135deg, #CBD5E0 0%, #A0AEC0 100%);
  box-shadow: 0 0 20px rgba(113, 128, 150, 0.4);
}

.cfg-node-block {
  border-color: #A0AEC0;
  background: linear-gradient(135deg, #F7FAFC 0%, #E2E8F0 100%);
  border-style: dashed;
}
.cfg-node-block-executed {
  border-color: #718096;
  background: linear-gradient(135deg, #E2E8F0 0%, #CBD5E0 100%);
  border-style: dashed;
  box-shadow: 0 0 20px rgba(160, 174, 192, 0.4);
}

.ws-panel-head-clickable {
  cursor: pointer;
  user-select: none;
  display: flex;
  width: 100%;
  justify-content: space-between;
  align-items: center;
  transition: background 0.2s ease;
  background: transparent;
  border: none;
  text-align: left;
  font-family: 'Plus Jakarta Sans', sans-serif;
  font-weight: 600;
  font-size: 14px;
  color: var(--neu-fg);
  padding: 16px 20px 12px;
  border-bottom: 1px solid rgba(163, 177, 198, 0.15);
  flex-shrink: 0;
}

.ws-panel-head-clickable:hover {
  background: rgba(163, 177, 198, 0.08);
}

.ws-panel-head-clickable:focus-visible {
  outline: 2px solid var(--neu-accent);
  outline-offset: -2px;
}

.ws-panel-collapse-icon {
  font-size: 11px;
  color: var(--neu-muted);
  flex-shrink: 0;
}

/* Left collapsing panel (Procedure Input) */
.ws-panel-input.ws-panel-collapsed-left {
  width: 48px !important;
  min-width: 48px !important;
}

.ws-panel-input.ws-panel-collapsed-left .ws-panel-body {
  display: none;
}

.ws-panel-input.ws-panel-collapsed-left .ws-panel-head-clickable {
  flex-direction: column;
  padding: 16px 0;
  align-items: center;
  justify-content: flex-start;
  gap: 10px;
  border-bottom: none;
  height: 100%;
}

.ws-panel-input.ws-panel-collapsed-left .ws-panel-head-clickable span:first-child {
  writing-mode: vertical-rl;
  text-orientation: mixed;
  font-size: 11px;
  letter-spacing: 0.05em;
  transform: rotate(180deg);
}

/* Right collapsing panel (Execution & AI) */
.ws-panel-trace.ws-panel-collapsed-right {
  width: 48px !important;
  min-width: 48px !important;
}

.ws-panel-trace.ws-panel-collapsed-right .ws-panel-body {
  display: none;
}

.ws-panel-trace.ws-panel-collapsed-right .ws-panel-head-clickable {
  flex-direction: column;
  padding: 16px 0;
  align-items: center;
  justify-content: flex-start;
  gap: 10px;
  border-bottom: none;
  height: 100%;
}

.ws-panel-trace.ws-panel-collapsed-right .ws-panel-head-clickable span:first-child {
  writing-mode: vertical-rl;
  text-orientation: mixed;
  font-size: 11px;
  letter-spacing: 0.05em;
}

/* Adjust grid when panels are collapsed */
.ws-main-grid:has(.ws-panel-input.ws-panel-collapsed-left) {
  grid-template-columns: 48px 1fr 360px;
}

.ws-main-grid:has(.ws-panel-trace.ws-panel-collapsed-right) {
  grid-template-columns: 320px 1fr 48px;
}

.ws-main-grid:has(.ws-panel-input.ws-panel-collapsed-left):has(.ws-panel-trace.ws-panel-collapsed-right) {
  grid-template-columns: 48px 1fr 48px;
}

.line-potential {
  background: transparent;
  height: 2px;
  border-top: 2px dashed #48BB78;
}

.ws-panel-body {
  flex: 1;
  min-height: 0;
  display: flex;
  flex-direction: column;
  position: relative;
  overflow: hidden;
}


.ws-panel-scroll {
  flex: 1;
  overflow-y: auto;
  padding: 12px 16px;
  min-height: 0;
}

/* AI message markdown rendering */
.ai-markdown {
  font-size: 13px;
  color: var(--neu-fg);
  line-height: 1.6;
  word-break: break-word;
}

.ai-markdown p {
  margin: 0 0 8px 0;
}

.ai-markdown p:last-child {
  margin-bottom: 0;
}

.ai-markdown strong {
  font-weight: 600;
  color: var(--neu-fg);
}

.ai-markdown em {
  font-style: italic;
}

.ai-markdown code {
  font-family: 'Cascadia Code', 'Fira Code', monospace;
  font-size: 12px;
  background: var(--neu-bg);
  box-shadow: var(--neu-inset-deep);
  border-radius: 4px;
  padding: 1px 6px;
  color: var(--neu-accent);
}

.ai-markdown pre {
  background: var(--neu-bg);
  box-shadow: var(--neu-inset-deep);
  border-radius: 10px;
  padding: 12px;
  overflow-x: auto;
  margin: 8px 0;
}

.ai-markdown pre code {
  background: none;
  box-shadow: none;
  padding: 0;
  color: var(--neu-fg);
  font-size: 12px;
}

.ai-markdown ul,
.ai-markdown ol {
  margin: 4px 0 8px 0;
  padding-left: 20px;
}

.ai-markdown li {
  margin-bottom: 4px;
}

.ai-markdown li:last-child {
  margin-bottom: 0;
}

.ai-markdown h1,
.ai-markdown h2,
.ai-markdown h3,
.ai-markdown h4 {
  font-weight: 600;
  color: var(--neu-fg);
  margin: 12px 0 6px 0;
  line-height: 1.3;
}

.ai-markdown h1 { font-size: 16px; }
.ai-markdown h2 { font-size: 15px; }
.ai-markdown h3 { font-size: 14px; }
.ai-markdown h4 { font-size: 13px; }

.ai-markdown h1:first-child,
.ai-markdown h2:first-child,
.ai-markdown h3:first-child {
  margin-top: 0;
}

.ai-markdown blockquote {
  border-left: 3px solid var(--neu-accent);
  margin: 8px 0;
  padding: 4px 12px;
  color: var(--neu-muted);
  font-style: italic;
}

.ai-markdown hr {
  border: none;
  border-top: 1px solid var(--neu-border, #e8e8e8);
  margin: 12px 0;
}

.ai-markdown a {
  color: var(--neu-accent);
  text-decoration: underline;
}

.ws-panel-scroll::-webkit-scrollbar {
  width: 6px;
}

.ws-panel-scroll::-webkit-scrollbar-track {
  background: transparent;
}

.ws-panel-scroll::-webkit-scrollbar-thumb {
  background: rgba(163, 177, 198, 0.4);
  border-radius: 3px;
}
